<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>EarnKaro | Earn Virtual Rewards</title>
    <meta name="description" content="A simulated ad-watching platform where users earn virtual coins by completing offers and watching video ads.">
    <meta property="og:title" content="EarnKaro | Earn Virtual Rewards">
    <meta property="og:description" content="Watch ads, complete surveys, and earn virtual coins in this simulation platform.">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#4f46e5">
    <link rel="canonical" href="https://earnkaro.gamer.gd" />
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’°</text></svg>">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts and Styles -->
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
      
      body { 
          font-family: 'Inter', sans-serif; 
          background-color: #0f172a; /* Slate 900 fallback */
          overscroll-behavior-y: none; /* Prevent pull-to-refresh on mobile */
      }
      
      /* Custom scrollbar */
      .scrollbar-thin::-webkit-scrollbar { width: 6px; }
      .scrollbar-thin::-webkit-scrollbar-track { background: #0f172a; }
      .scrollbar-thin::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
      .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #475569; }

      /* Animation utilities */
      .animate-in { animation: fadeIn 0.3s ease-out; }
      @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
      
      /* Loading Spinner for Initial Load */
      .initial-loader {
          position: fixed; top: 0; left: 0; width: 100%; height: 100%;
          background: #0f172a; display: flex; flex-direction: column;
          align-items: center; justify-content: center; z-index: 9999;
          color: white; transition: opacity 0.5s ease-out;
      }
      .spinner {
          width: 40px; height: 40px;
          border: 4px solid rgba(255,255,255,0.1);
          border-left-color: #4f46e5;
          border-radius: 50%;
          animation: spin 1s linear infinite;
      }
      @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>

    <!-- Babel for in-browser compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Import Map -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.344.0"
      }
    }
    </script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <!-- Initial Loading State (Removed by React when mounted) -->
    <div id="root">
        <div class="initial-loader">
            <div class="spinner"></div>
            <p style="margin-top: 1rem; font-weight: 500; opacity: 0.8; font-size: 0.9rem;">Initializing EarnKaro...</p>
        </div>
    </div>

    <!-- Application Script -->
    <script type="text/babel" data-type="module" data-presets="react">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            Sparkles, Trophy, Video, Infinity, Zap, XCircle, Coins,
            X, CheckCircle, Loader2, Server, MousePointer2, RefreshCw, 
            ArrowLeft, Eye, ExternalLink, ArrowLeftCircle, Clock, 
            LayoutTemplate, User, Mail, PlayCircle, ClipboardList, 
            Gamepad2, Share2, AlertTriangle
        } from 'lucide-react';

        // ------------------------------------------------------------------
        // CONFIG & DATA
        // ------------------------------------------------------------------

        const CONFIG = {
            SILENT_AUDIO: "data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",
            ANIMATION_SPEED: 1,
        };

        const OFFERS = [
            { id: '1', title: 'Watch Video Ad', description: 'Watch a short promotional video', reward: 10, iconType: 'video' },
            { id: '2', title: 'Complete Survey', description: 'Share your opinion on new products', reward: 50, iconType: 'survey' },
            { id: '3', title: 'Game Trial', description: 'Play our featured game for 30s', reward: 30, iconType: 'game' },
            { id: '4', title: 'Share on Social', description: 'Tell your friends about us', reward: 25, iconType: 'social' },
        ];

        // Mock Data Generators
        const NAMES = {
            first: ["James", "Mary", "Robert", "Patricia", "John", "Jennifer", "Michael", "Linda", "David", "Elizabeth", "William", "Barbara", "Richard", "Susan", "Joseph", "Jessica"],
            last: ["Smith", "Johnson", "Williams", "Brown", "Jones", "Garcia", "Miller", "Davis", "Rodriguez", "Martinez", "Hernandez", "Lopez", "Gonzalez", "Wilson"]
        };
        const DOMAINS = ["gmail.com", "yahoo.com", "hotmail.com", "outlook.com", "protonmail.com"];

        const generateMockIdentity = (seed) => {
            const firstName = NAMES.first[Math.floor(Math.random() * NAMES.first.length)];
            const lastName = NAMES.last[Math.floor(Math.random() * NAMES.last.length)];
            const domain = DOMAINS[Math.floor(Math.random() * DOMAINS.length)];
            const emailUser = `${firstName.toLowerCase()}.${lastName.toLowerCase()}${Math.floor(Math.random()*99)}`;
            
            return {
                name: `${firstName} ${lastName}`,
                email: `${emailUser}@${domain}`,
                avatarColor: `hsl(${Math.floor(Math.random() * 360)}, 70%, 45%)`
            };
        };

        // Ad Template Generator (Safe HTML construction)
        const getPublisherTemplate = (seed) => {
            const closingScript = '<' + '/script>';
            const hue = (seed * 137) % 360; 
            const type = Math.floor((seed % 4)); 
            const baseStyle = `font-family: system-ui, -apple-system, sans-serif; padding: 20px; box-sizing: border-box;`;

            // Common scripts injected into the iframe
            const commonScripts = `
                <script>
                    // Scroll simulation
                    function autoScroll() {
                        if(window.scrollY < document.body.scrollHeight - window.innerHeight) {
                            window.scrollBy({ top: 40 + Math.random() * 40, behavior: 'smooth' });
                            setTimeout(autoScroll, 500 + Math.random() * 1000);
                        }
                    }
                    setTimeout(autoScroll, 1000);
                ${closingScript}
            `;

            if (type === 0) { // Lite Blog
                return `
                    <div style="${baseStyle} background-color: hsl(${hue}, 50%, 96%); min-height: 100vh;">
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="width: 40%; height: 20px; background: #e2e8f0; border-radius: 4px; margin-bottom: 10px;"></div>
                            <div style="width: 100%; height: 120px; background: #f1f5f9; border-radius: 4px;"></div>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #fff; margin: 20px 0;">
                            <span style="font-size: 10px; color: #94a3b8; letter-spacing: 1px;">ADVERTISEMENT</span>
                            <div style="width: 300px; height: 250px; background: #e2e8f0; margin: 10px auto; display: flex; align-items: center; justify-content: center; color: #64748b;">
                                300x250 Banner
                            </div>
                        </div>
                        ${commonScripts}
                    </div>
                `;
            }

            if (type === 1) { // News Site
                return `
                    <div style="${baseStyle} background: #fff; color: #1e293b;">
                        <h1 style="font-size: 20px; font-weight: 800; color: hsl(${hue}, 70%, 30%); margin-bottom: 10px;">Daily Trends</h1>
                        <p style="font-size: 14px; line-height: 1.5; color: #475569;">Analysis of the current market situation indicates a shift in consumer behavior.</p>
                        <div style="margin: 20px 0; border: 1px solid #e2e8f0; padding: 10px;">
                            <div style="background: #f8fafc; height: 200px; display: flex; align-items: center; justify-content: center; color: #94a3b8;">
                                Sponsored Content
                            </div>
                        </div>
                        ${commonScripts}
                    </div>
                `;
            }

            if (type === 2) { // Dark Mode Tech
                return `
                    <div style="${baseStyle} background-color: #0f172a; color: #e2e8f0; min-height: 100vh;">
                        <div style="border-bottom: 1px solid #1e293b; padding-bottom: 10px; margin-bottom: 15px;">
                            <span style="color: #38bdf8; font-weight: bold;">TECH<span style="color:#fff">NV</span></span>
                        </div>
                        <div style="background: #1e293b; padding: 15px; border-radius: 6px;">
                            <div style="height: 10px; width: 70%; background: #334155; margin-bottom: 10px;"></div>
                            <div style="height: 10px; width: 90%; background: #334155;"></div>
                        </div>
                        <div style="margin-top: 20px; display: flex; justify-content: center;">
                            <div style="width: 300px; height: 100px; background: #1e293b; border: 1px dashed #475569; display: flex; align-items: center; justify-content: center; font-size: 10px;">
                                Ad Space
                            </div>
                        </div>
                        ${commonScripts}
                    </div>
                `;
            }

            return `
                <div style="${baseStyle} background: #f0fdf4;">
                    <div style="background: #fff; padding: 12px; border-radius: 8px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); border-left: 4px solid #22c55e;">
                        <div style="font-weight: bold; font-size: 14px;">Eco Friendly Tips</div>
                        <div style="font-size: 12px; color: #64748b; margin-top: 4px;">Read more about sustainability...</div>
                    </div>
                    ${commonScripts}
                </div>
            `;
        };

        // ------------------------------------------------------------------
        // COMPONENTS
        // ------------------------------------------------------------------

        // --- Error Boundary ---
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }
            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }
            componentDidCatch(error, errorInfo) {
                console.error("ErrorBoundary caught an error", error, errorInfo);
            }
            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen flex items-center justify-center bg-slate-900 text-white p-6">
                            <div className="max-w-md text-center">
                                <AlertTriangle className="w-16 h-16 text-red-500 mx-auto mb-4" />
                                <h1 className="text-2xl font-bold mb-2">Something went wrong</h1>
                                <p className="text-slate-400 mb-6">We encountered an unexpected error. Please try refreshing the page.</p>
                                <button 
                                    onClick={() => window.location.reload()}
                                    className="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-medium transition-colors"
                                >
                                    Refresh Page
                                </button>
                                <pre className="mt-8 p-4 bg-slate-800 rounded text-left text-xs overflow-auto max-h-40 text-red-300">
                                    {this.state.error?.toString()}
                                </pre>
                            </div>
                        </div>
                    );
                }
                return this.props.children;
            }
        }

        // --- Wallet Component ---
        const Wallet = ({ amount }) => (
            <div className="flex flex-col items-center justify-center p-8 bg-slate-50 border-b border-gray-200">
                <div className="flex items-center gap-4">
                    <div className="p-4 bg-yellow-100 rounded-full shadow-inner ring-4 ring-yellow-50">
                        <Coins className="w-10 h-10 text-yellow-600" />
                    </div>
                    <div className="text-left">
                        <div className="text-4xl font-bold text-slate-900 tabular-nums tracking-tight">
                            {amount.toLocaleString()}
                        </div>
                        <div className="text-xs font-semibold text-slate-500 uppercase tracking-wider">
                            Total Coins Earned
                        </div>
                    </div>
                </div>
            </div>
        );

        // --- OfferCard Component ---
        const OfferCard = ({ offer, onStart, disabled }) => {
            const icons = {
                video: PlayCircle,
                survey: ClipboardList,
                game: Gamepad2,
                social: Share2,
            };
            const Icon = icons[offer.iconType] || Sparkles;

            const colors = {
                video: 'from-blue-100 to-blue-200 text-blue-600',
                survey: 'from-purple-100 to-purple-200 text-purple-600',
                game: 'from-green-100 to-green-200 text-green-600',
                social: 'from-pink-100 to-pink-200 text-pink-600',
            };

            return (
                <div className="group bg-white border border-slate-200 rounded-xl p-5 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 transition-all duration-300 hover:shadow-lg hover:border-indigo-200 hover:-translate-y-0.5">
                    <div className="flex items-start gap-4">
                        <div className={`p-3 rounded-xl bg-gradient-to-br ${colors[offer.iconType]} shadow-sm`}>
                            <Icon size={24} strokeWidth={2.5} />
                        </div>
                        <div>
                            <h3 className="font-bold text-slate-800 text-lg group-hover:text-indigo-600 transition-colors">
                                {offer.title}
                            </h3>
                            <p className="text-slate-500 text-sm mt-1 leading-relaxed">{offer.description}</p>
                        </div>
                    </div>
                    <div className="flex items-center justify-between w-full sm:w-auto gap-4 mt-2 sm:mt-0">
                        <span className="font-bold text-yellow-700 bg-yellow-50 px-3 py-1 rounded-lg text-sm whitespace-nowrap border border-yellow-200/50">
                            +{offer.reward} Coins
                        </span>
                        <button
                            onClick={() => onStart(offer)}
                            disabled={disabled}
                            className="bg-slate-900 hover:bg-indigo-600 text-white font-semibold py-2.5 px-6 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-indigo-500/20 active:scale-95"
                        >
                            Start
                        </button>
                    </div>
                </div>
            );
        };

        // --- Ad Unit Component ---
        const AdStreamUnit = ({ index }) => {
            const [content, setContent] = useState('');
            const [identity] = useState(() => generateMockIdentity(index));
            const [viewState, setViewState] = useState('banner'); // banner, visiting
            const [timer, setTimer] = useState(0);

            // Cycle logic
            useEffect(() => {
                // Initialize content
                const html = `
                    <!DOCTYPE html>
                    <html><head><style>body{margin:0;overflow:hidden;}</style></head><body>
                    ${getPublisherTemplate(index)}
                    <script type="module" src="/index.tsx"></script>
</body></html>
                `;
                setContent(html);

                // Simulation loop
                const cycleTime = 15000 + Math.random() * 10000;
                
                const interval = setInterval(() => {
                    setViewState(prev => prev === 'banner' ? 'visiting' : 'banner');
                }, cycleTime);

                return () => clearInterval(interval);
            }, [index]);

            return (
                <div className="relative w-full h-[280px] bg-white rounded-lg overflow-hidden border border-slate-700/50 shadow-sm hover:shadow-md transition-all group">
                    {/* Status Bar */}
                    <div className="absolute top-0 inset-x-0 z-20 flex justify-between items-center p-2 pointer-events-none">
                        <div className="bg-slate-900/80 backdrop-blur text-xs font-mono text-slate-400 px-2 py-1 rounded border border-white/10">
                            SESSION #{index}
                        </div>
                        <div className={`
                            px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider backdrop-blur border
                            ${viewState === 'visiting' ? 'bg-indigo-500/80 text-white border-indigo-400' : 'bg-emerald-500/80 text-white border-emerald-400'}
                        `}>
                            {viewState === 'visiting' ? 'Browsing' : 'Viewing Ad'}
                        </div>
                    </div>

                    {/* Iframe Content */}
                    <iframe 
                        srcDoc={content}
                        className={`w-full h-full transition-opacity duration-500 ${viewState === 'visiting' ? 'opacity-30 blur-[2px]' : 'opacity-100'}`}
                        sandbox="allow-scripts"
                        scrolling="no"
                        title={`Ad Unit ${index}`}
                    />

                    {/* Visiting Overlay */}
                    {viewState === 'visiting' && (
                        <div className="absolute inset-0 z-10 flex flex-col items-center justify-center p-4 animate-in">
                            <div className="bg-white p-4 rounded-xl shadow-xl w-full max-w-[90%] border border-slate-100">
                                <div className="flex items-center gap-3 mb-3 border-b border-slate-100 pb-2">
                                    <div 
                                        className="w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-xs"
                                        style={{ backgroundColor: identity.avatarColor }}
                                    >
                                        {identity.name.charAt(0)}
                                    </div>
                                    <div className="overflow-hidden">
                                        <div className="font-bold text-xs text-slate-800 truncate">{identity.name}</div>
                                        <div className="text-[10px] text-slate-500 truncate">{identity.email}</div>
                                    </div>
                                </div>
                                <div className="space-y-2">
                                    <div className="h-2 bg-slate-100 rounded w-3/4"></div>
                                    <div className="h-2 bg-slate-100 rounded w-full"></div>
                                    <div className="h-2 bg-slate-100 rounded w-5/6"></div>
                                </div>
                                <div className="mt-4 flex justify-end">
                                    <div className="bg-blue-600 h-6 w-20 rounded animate-pulse"></div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // --- Main App Component ---
        function App() {
            const [coins, setCoins] = useState(0);
            const [isAdOpen, setIsAdOpen] = useState(false);
            const [adMode, setAdMode] = useState('single'); // single, grid
            const [activeOffer, setActiveOffer] = useState(null);
            const [toasts, setToasts] = useState([]);
            
            // Grid Worker
            const workerRef = useRef(null);
            const [gridRewardTimer, setGridRewardTimer] = useState(0);

            // Load Coins
            useEffect(() => {
                const saved = localStorage.getItem('ek_coins');
                if (saved) setCoins(parseInt(saved, 10));
            }, []);

            // Save Coins
            useEffect(() => {
                localStorage.setItem('ek_coins', coins.toString());
            }, [coins]);

            // Web Worker for Background Processing
            useEffect(() => {
                const workerCode = `
                    let timer = null;
                    self.onmessage = (e) => {
                        if(e.data === 'START') {
                            timer = setInterval(() => self.postMessage('TICK'), 5000); // Fast ticks for demo
                        } else {
                            clearInterval(timer);
                        }
                    }
                `;
                const blob = new Blob([workerCode], {type: 'application/javascript'});
                workerRef.current = new Worker(URL.createObjectURL(blob));
                
                workerRef.current.onmessage = (e) => {
                    if(e.data === 'TICK') {
                        setCoins(c => c + 50);
                        showToast('+50 Passive Income', 'success');
                    }
                };

                return () => workerRef.current.terminate();
            }, []);

            // Control Worker
            useEffect(() => {
                if (isAdOpen && adMode === 'grid') {
                    workerRef.current.postMessage('START');
                } else {
                    workerRef.current.postMessage('STOP');
                }
            }, [isAdOpen, adMode]);

            const showToast = (text, type = 'success') => {
                const id = Date.now();
                setToasts(prev => [...prev, {id, text, type}]);
                setTimeout(() => setToasts(prev => prev.filter(t => t.id !== id)), 3000);
            };

            const handleStartOffer = (offer) => {
                if (isAdOpen) {
                    showToast('Finish current task first', 'error');
                    return;
                }
                setActiveOffer(offer);
                setAdMode('single');
                setIsAdOpen(true);
            };

            const handleUnlimited = () => {
                if (isAdOpen) {
                    setIsAdOpen(false);
                    return;
                }
                setActiveOffer({ id: 'grid', title: 'Unlimited Grid', reward: 0 });
                setAdMode('grid');
                setIsAdOpen(true);
                showToast('Started 100 concurrent streams', 'success');
            };

            const handleSingleComplete = () => {
                setCoins(c => c + (activeOffer?.reward || 0));
                showToast(`Earned ${activeOffer?.reward} Coins!`, 'success');
                setIsAdOpen(false);
                setActiveOffer(null);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-slate-900 to-indigo-950 p-4 md:p-8 flex justify-center items-center font-sans selection:bg-indigo-500 selection:text-white">
                    <div className="w-full max-w-3xl bg-white rounded-3xl shadow-2xl overflow-hidden flex flex-col ring-1 ring-white/10">
                        
                        {/* Header */}
                        <div className="bg-gradient-to-r from-indigo-600 to-violet-600 p-8 text-center text-white relative overflow-hidden">
                            <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-20"></div>
                            <div className="relative z-10">
                                <h1 className="text-4xl font-extrabold mb-2 tracking-tight drop-shadow-sm">EarnKaro</h1>
                                <p className="text-indigo-100 text-lg font-medium opacity-90">Micro-task simulation platform</p>
                            </div>
                        </div>

                        <Wallet amount={coins} />

                        <div className="p-6 md:p-8 flex-grow bg-slate-50">
                            
                            {/* Quick Actions */}
                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8">
                                <button
                                    onClick={() => handleStartOffer({ id: 'quick', title: 'Quick Ad', reward: 15, iconType: 'video' })}
                                    disabled={isAdOpen && adMode === 'grid'}
                                    className={`group relative overflow-hidden rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-600 p-1 shadow-lg hover:shadow-cyan-500/30 transition-all duration-300 hover:-translate-y-1 ${isAdOpen && adMode === 'grid' ? 'opacity-50 grayscale' : ''}`}
                                >
                                    <div className="bg-white/10 backdrop-blur-sm h-full p-6 rounded-xl flex flex-col items-center justify-center text-white">
                                        <Video className="w-10 h-10 mb-3 drop-shadow-md" />
                                        <span className="text-xl font-bold mb-1">Watch Ad</span>
                                        <span className="text-xs bg-white/20 px-2 py-1 rounded-full">+15 Coins</span>
                                    </div>
                                </button>

                                <button
                                    onClick={handleUnlimited}
                                    className={`group relative overflow-hidden rounded-2xl p-1 shadow-lg transition-all duration-300 hover:-translate-y-1 ${isAdOpen && adMode === 'grid' ? 'bg-gradient-to-br from-red-500 to-orange-500 shadow-orange-500/30' : 'bg-gradient-to-br from-fuchsia-600 to-purple-600 shadow-purple-500/30'}`}
                                >
                                    <div className="bg-white/10 backdrop-blur-sm h-full p-6 rounded-xl flex flex-col items-center justify-center text-white">
                                        {isAdOpen && adMode === 'grid' ? <XCircle className="w-10 h-10 mb-3 animate-pulse" /> : <Zap className="w-10 h-10 mb-3" />}
                                        <span className="text-xl font-bold mb-1">{isAdOpen && adMode === 'grid' ? 'Stop Grid' : 'Unlimited Grid'}</span>
                                        <span className="text-xs bg-white/20 px-2 py-1 rounded-full flex items-center gap-1">
                                            <Infinity size={10} /> {isAdOpen && adMode === 'grid' ? 'Running...' : 'Auto-Earn'}
                                        </span>
                                    </div>
                                </button>
                            </div>

                            {/* Offers List */}
                            <div className="flex items-center justify-between mb-4">
                                <h2 className="text-xl font-bold text-slate-800">Available Offers</h2>
                                <span className="text-xs font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded-full border border-indigo-100">{OFFERS.length} Active</span>
                            </div>
                            <div className="space-y-3">
                                {OFFERS.map(offer => (
                                    <OfferCard 
                                        key={offer.id} 
                                        offer={offer} 
                                        onStart={handleStartOffer} 
                                        disabled={isAdOpen} 
                                    />
                                ))}
                            </div>
                        </div>

                        <div className="bg-white p-4 text-center text-xs text-slate-400 border-t border-slate-100">
                            &copy; {new Date().getFullYear()} EarnKaro. Simulated environment. No real value.
                        </div>
                    </div>

                    {/* Modals */}
                    {isAdOpen && (
                        adMode === 'single' ? (
                            <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4 animate-in">
                                <div className="bg-white rounded-2xl w-full max-w-md overflow-hidden relative">
                                    <div className="bg-slate-900 text-white p-4 flex justify-between items-center">
                                        <span className="font-bold flex items-center gap-2"><Video size={16}/> Watching Ad</span>
                                        <button onClick={() => setIsAdOpen(false)} className="hover:text-red-400"><X size={20}/></button>
                                    </div>
                                    <div className="p-6 flex flex-col items-center">
                                        <div className="w-full h-48 bg-slate-100 rounded-lg mb-4 overflow-hidden relative border border-slate-200">
                                            <iframe srcDoc={getPublisherTemplate(Math.random())} className="w-full h-full pointer-events-none" />
                                            <div className="absolute inset-0 flex items-center justify-center bg-black/50 text-white font-bold backdrop-blur-[1px]">
                                                Ad Playing...
                                            </div>
                                        </div>
                                        <div className="w-full bg-slate-100 h-2 rounded-full overflow-hidden mb-4">
                                            <div className="bg-indigo-600 h-full animate-[width_3s_linear_forwards]" style={{width: '0%', animationName: 'growWidth'}}></div>
                                            <style>{`@keyframes growWidth { to { width: 100%; } }`}</style>
                                        </div>
                                        <p className="text-slate-500 text-sm mb-4">Reward arriving shortly...</p>
                                        <div style={{animation: 'fadeIn 0.5s 3s forwards', opacity: 0}}>
                                            <button onClick={handleSingleComplete} className="bg-green-600 text-white px-8 py-2 rounded-full font-bold shadow-lg hover:scale-105 transition-transform">
                                                Collect Reward
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div className="fixed inset-0 z-50 bg-slate-900 flex flex-col animate-in">
                                <div className="bg-slate-800 text-white p-4 flex justify-between items-center shadow-md z-10 border-b border-slate-700">
                                    <div className="flex items-center gap-4">
                                        <button onClick={() => setIsAdOpen(false)} className="bg-slate-700 hover:bg-slate-600 p-2 rounded-full"><ArrowLeft/></button>
                                        <div>
                                            <h2 className="font-bold text-lg flex items-center gap-2 text-green-400"><Server size={18}/> HUMAN-AI CLOUD</h2>
                                            <div className="text-xs text-slate-400">Running 100 Isolated Sessions â€¢ Auto-Click Enabled</div>
                                        </div>
                                    </div>
                                    <button onClick={() => setIsAdOpen(false)} className="bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-sm font-bold">TERMINATE</button>
                                </div>
                                <div className="flex-grow p-4 overflow-y-auto bg-slate-950/50">
                                    <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                                        {Array.from({length: 48}).map((_, i) => (
                                            <AdStreamUnit key={i} index={i + 1} />
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )
                    )}

                    {/* Toasts */}
                    <div className="fixed bottom-8 left-1/2 -translate-x-1/2 flex flex-col gap-2 z-[60] pointer-events-none w-full max-w-sm px-4">
                        {toasts.map(t => (
                            <div key={t.id} className={`p-4 rounded-xl shadow-xl border flex items-center gap-3 animate-in slide-in-from-bottom-5 bg-white text-slate-800 border-slate-200`}>
                                {t.type === 'success' ? <CheckCircle className="text-green-500" size={20}/> : <AlertTriangle className="text-red-500" size={20}/>}
                                <span className="font-medium">{t.text}</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // --- Mount ---
        const root = createRoot(document.getElementById('root'));
        root.render(
            <ErrorBoundary>
                <App />
            </ErrorBoundary>
        );
    </script>
</body>
</html>